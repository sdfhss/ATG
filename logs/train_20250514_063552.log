------------ Options -------------
anormly_ratio: 4.0
batch_size: 256
d_ff: 32
d_model: 32
data_path: ./dataset/SWaT
dataset: SWaT
dynamic_graph: True
e_layers: 1
fusion_method: add
gnn_heads: 1
gnn_hidden: 32
gnn_layers: 1
gnn_type: gatv2
input_c: 51
k: 3
k_neighbors: 2
lr: 0.0001
mode: train
model_save_path: ./checkpoints
model_type: advanced_transgnn
n_heads: 2
no_time_limit: False
num_epochs: 3
output_c: 51
pretrained_model: None
residual: True
win_size: 50
-------------- End ----------------
自动调整batch_size: 256 -> 1024 (GPU内存: 23.59GB可用)
当前GPU利用率: 0.00%，目标提高到60-80%
训练数据特征数量: 51
测试数据特征数量: 50
已填充测试数据至 51 个特征
test: (495000, 51)
train: (495000, 51)
训练数据特征数量: 51
测试数据特征数量: 50
已填充测试数据至 51 个特征
test: (495000, 51)
train: (495000, 51)
训练数据特征数量: 51
测试数据特征数量: 50
已填充测试数据至 51 个特征
test: (495000, 51)
train: (495000, 51)
训练数据特征数量: 51
测试数据特征数量: 50
已填充测试数据至 51 个特征
test: (495000, 51)
train: (495000, 51)
检测到大显存GPU (23.6GB)，自动优化模型参数
已强制启用自动混合精度训练，提高GPU利用率
使用单GPU训练 - RTX 3090
模型总参数量: 3.72M 参数
初始GPU内存分配: 0.03GB
初始GPU内存预留: 0.04GB
已设置GPU内存使用上限为95%
CUDA性能优化设置完成，已针对RTX 3090进行优化
======================TRAIN MODE======================
降低batch_size以解决OOM问题: 1024 -> 256
训练数据特征数量: 51
测试数据特征数量: 50
已填充测试数据至 51 个特征
test: (495000, 51)
train: (495000, 51)
训练数据特征数量: 51
测试数据特征数量: 50
已填充测试数据至 51 个特征
test: (495000, 51)
train: (495000, 51)
训练数据特征数量: 51
测试数据特征数量: 50
已填充测试数据至 51 个特征
test: (495000, 51)
train: (495000, 51)
训练数据特征数量: 51
测试数据特征数量: 50
已填充测试数据至 51 个特征
test: (495000, 51)
train: (495000, 51)
已清空CUDA缓存，准备开始训练

开始第 1/3 轮训练
Epoch 1/3:   0%|          | 0/1934 [00:00<?, ?it/s]Epoch 1/3:   0%|          | 0/1934 [00:06<?, ?it/s, loss=-23.0082, speed=6.69s/iter, memory=0.3GB/23.6GB (1%), gpu_mem=0.3GB]Epoch 1/3:   0%|          | 1/1934 [00:06<3:35:34,  6.69s/it, loss=-23.0082, speed=6.69s/iter, memory=0.3GB/23.6GB (1%), gpu_mem=0.3GB]Epoch 1/3:   0%|          | 1/1934 [00:12<3:35:34,  6.69s/it, loss=-23.2977, speed=6.02s/iter, memory=0.3GB/23.6GB (1%), gpu_mem=0.3GB]Epoch 1/3:   0%|          | 2/1934 [00:12<3:10:08,  5.90s/it, loss=-23.2977, speed=6.02s/iter, memory=0.3GB/23.6GB (1%), gpu_mem=0.3GB]Epoch 1/3:   0%|          | 2/1934 [00:17<3:10:08,  5.90s/it, loss=-23.3554, speed=5.73s/iter, memory=0.3GB/23.6GB (1%), gpu_mem=0.3GB]Epoch 1/3:   0%|          | 3/1934 [00:17<2:58:52,  5.56s/it, loss=-23.3554, speed=5.73s/iter, memory=0.3GB/23.6GB (1%), gpu_mem=0.3GB]Epoch 1/3:   0%|          | 3/1934 [00:22<2:58:52,  5.56s/it, loss=-23.2313, speed=5.58s/iter, memory=0.3GB/23.6GB (1%), gpu_mem=0.3GB]Epoch 1/3:   0%|          | 4/1934 [00:22<2:53:30,  5.39s/it, loss=-23.2313, speed=5.58s/iter, memory=0.3GB/23.6GB (1%), gpu_mem=0.3GB]Epoch 1/3:   0%|          | 4/1934 [00:27<2:53:30,  5.39s/it, loss=-23.7203, speed=5.50s/iter, memory=0.3GB/23.6GB (1%), gpu_mem=0.3GB]Epoch 1/3:   0%|          | 5/1934 [00:27<2:50:51,  5.31s/it, loss=-23.7203, speed=5.50s/iter, memory=0.3GB/23.6GB (1%), gpu_mem=0.3GB]Epoch 1/3:   0%|          | 5/1934 [00:32<2:50:51,  5.31s/it, loss=-24.2125, speed=5.43s/iter, memory=0.3GB/23.6GB (1%), gpu_mem=0.3GB]Epoch 1/3:   0%|          | 6/1934 [00:32<2:47:59,  5.23s/it, loss=-24.2125, speed=5.43s/iter, memory=0.3GB/23.6GB (1%), gpu_mem=0.3GB]Epoch 1/3:   0%|          | 6/1934 [00:37<2:47:59,  5.23s/it, loss=-24.2597, speed=5.39s/iter, memory=0.3GB/23.6GB (1%), gpu_mem=0.3GB]Epoch 1/3:   0%|          | 7/1934 [00:37<2:47:08,  5.20s/it, loss=-24.2597, speed=5.39s/iter, memory=0.3GB/23.6GB (1%), gpu_mem=0.3GB]Epoch 1/3:   0%|          | 7/1934 [00:42<2:47:08,  5.20s/it, loss=-24.0598, speed=5.29s/iter, memory=0.3GB/23.6GB (1%), gpu_mem=0.3GB]Epoch 1/3:   0%|          | 8/1934 [00:42<2:41:05,  5.02s/it, loss=-24.0598, speed=5.29s/iter, memory=0.3GB/23.6GB (1%), gpu_mem=0.3GB]Epoch 1/3:   0%|          | 8/1934 [00:46<2:41:05,  5.02s/it, loss=-24.9349, speed=5.21s/iter, memory=0.3GB/23.6GB (1%), gpu_mem=0.3GB]Epoch 1/3:   0%|          | 9/1934 [00:46<2:35:50,  4.86s/it, loss=-24.9349, speed=5.21s/iter, memory=0.3GB/23.6GB (1%), gpu_mem=0.3GB]