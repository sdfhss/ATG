------------ Options -------------
anormly_ratio: 1.0
batch_size: 256
d_ff: 128
d_model: 128
data_path: ./dataset/MSL
dataset: MSL
dynamic_graph: True
e_layers: 2
fusion_method: weighted
gnn_heads: 2
gnn_hidden: 64
gnn_layers: 2
gnn_type: gatv2
input_c: 55
k: 3
k_neighbors: 3
lr: 0.0001
mode: train
model_save_path: ./checkpoints
model_type: advanced_transgnn
n_heads: 4
num_epochs: 3
output_c: 55
pretrained_model: None
residual: True
win_size: 50
-------------- End ----------------
test: (73729, 55)
train: (58317, 55)
test: (73729, 55)
train: (58317, 55)
test: (73729, 55)
train: (58317, 55)
test: (73729, 55)
train: (58317, 55)
初始化AdvancedAnomalyTransGNN - win_size:50, enc_in:55, c_out:55, d_model:128, n_heads:4
AdvancedAnomalyGNN初始化 - in_channels: 55, hidden_channels: 64, out_channels: 55
GATv2Layer初始化 - in_channels: 55, out_channels: 64, heads: 2
GATv2Layer初始化 - in_channels: 128, out_channels: 55, heads: 2
======================TRAIN MODE======================
CUDA缓存已清空
预热GPU...
AdvancedAnomalyGNN输入 - 形状: torch.Size([1, 30, 55]), 通道数: 55
展平后的输入 - 形状: torch.Size([30, 55])
GATv2Layer输入 - x: torch.Size([30, 55]), edge_index: torch.Size([2, 30])
GATv2Layer卷积后 - out: torch.Size([30, 128])
GATv2Layer输入 - x: torch.Size([30, 128]), edge_index: torch.Size([2, 30])
GATv2Layer卷积后 - out: torch.Size([30, 55])
GNN编码器输出 - 形状: torch.Size([30, 55])
注意力分数 - 形状: torch.Size([30, 1])
最终输出 - 形状: torch.Size([30, 55])
GPU预热成功

开始第 1/3 轮训练
总批次数: 228
Epoch 1/3:   0%|          | 0/228 [00:00<?, ?it/s]Epoch 1/3:   0%|          | 0/228 [00:21<?, ?it/s, loss=-94.5507, speed=21.82s/iter, memory=45MB]Epoch 1/3:   0%|          | 1/228 [00:21<1:21:06, 21.44s/it, loss=-94.5507, speed=21.82s/iter, memory=45MB]Epoch 1/3:   0%|          | 1/228 [00:42<1:21:06, 21.44s/it, loss=-94.4441, speed=21.41s/iter, memory=46MB]Epoch 1/3:   1%|          | 2/228 [00:42<1:19:47, 21.18s/it, loss=-94.4441, speed=21.41s/iter, memory=46MB]Epoch 1/3:   1%|          | 2/228 [01:03<1:19:47, 21.18s/it, loss=-93.7651, speed=21.29s/iter, memory=45MB]Epoch 1/3:   1%|▏         | 3/228 [01:03<1:19:11, 21.12s/it, loss=-93.7651, speed=21.29s/iter, memory=45MB]AdvancedAnomalyGNN输入 - 形状: torch.Size([64, 50, 55]), 通道数: 55
展平后的输入 - 形状: torch.Size([3200, 55])
GATv2Layer输入 - x: torch.Size([3200, 55]), edge_index: torch.Size([2, 11837])
GATv2Layer卷积后 - out: torch.Size([3200, 128])
GATv2Layer输入 - x: torch.Size([3200, 128]), edge_index: torch.Size([2, 11837])
GATv2Layer卷积后 - out: torch.Size([3200, 55])
GNN编码器输出 - 形状: torch.Size([3200, 55])
注意力分数 - 形状: torch.Size([3200, 1])
最终输出 - 形状: torch.Size([3200, 55])
AdvancedAnomalyGNN输入 - 形状: torch.Size([64, 50, 55]), 通道数: 55
展平后的输入 - 形状: torch.Size([3200, 55])
GATv2Layer输入 - x: torch.Size([3200, 55]), edge_index: torch.Size([2, 11609])
GATv2Layer卷积后 - out: torch.Size([3200, 128])
GATv2Layer输入 - x: torch.Size([3200, 128]), edge_index: torch.Size([2, 11609])
GATv2Layer卷积后 - out: torch.Size([3200, 55])
GNN编码器输出 - 形状: torch.Size([3200, 55])
注意力分数 - 形状: torch.Size([3200, 1])
最终输出 - 形状: torch.Size([3200, 55])
AdvancedAnomalyGNN输入 - 形状: torch.Size([64, 50, 55]), 通道数: 55
展平后的输入 - 形状: torch.Size([3200, 55])
GATv2Layer输入 - x: torch.Size([3200, 55]), edge_index: torch.Size([2, 11847])
GATv2Layer卷积后 - out: torch.Size([3200, 128])
GATv2Layer输入 - x: torch.Size([3200, 128]), edge_index: torch.Size([2, 11847])
GATv2Layer卷积后 - out: torch.Size([3200, 55])
GNN编码器输出 - 形状: torch.Size([3200, 55])
注意力分数 - 形状: torch.Size([3200, 1])
最终输出 - 形状: torch.Size([3200, 55])
AdvancedAnomalyGNN输入 - 形状: torch.Size([64, 50, 55]), 通道数: 55
展平后的输入 - 形状: torch.Size([3200, 55])
GATv2Layer输入 - x: torch.Size([3200, 55]), edge_index: torch.Size([2, 11872])
GATv2Layer卷积后 - out: torch.Size([3200, 128])
GATv2Layer输入 - x: torch.Size([3200, 128]), edge_index: torch.Size([2, 11872])
GATv2Layer卷积后 - out: torch.Size([3200, 55])
GNN编码器输出 - 形状: torch.Size([3200, 55])
注意力分数 - 形状: torch.Size([3200, 1])
最终输出 - 形状: torch.Size([3200, 55])
AdvancedAnomalyGNN输入 - 形状: torch.Size([64, 50, 55]), 通道数: 55
展平后的输入 - 形状: torch.Size([3200, 55])
GATv2Layer输入 - x: torch.Size([3200, 55]), edge_index: torch.Size([2, 11746])
GATv2Layer卷积后 - out: torch.Size([3200, 128])
GATv2Layer输入 - x: torch.Size([3200, 128]), edge_index: torch.Size([2, 11746])
GATv2Layer卷积后 - out: torch.Size([3200, 55])
GNN编码器输出 - 形状: torch.Size([3200, 55])
注意力分数 - 形状: torch.Size([3200, 1])
最终输出 - 形状: torch.Size([3200, 55])
AdvancedAnomalyGNN输入 - 形状: torch.Size([64, 50, 55]), 通道数: 55
展平后的输入 - 形状: torch.Size([3200, 55])
GATv2Layer输入 - x: torch.Size([3200, 55]), edge_index: torch.Size([2, 11631])
GATv2Layer卷积后 - out: torch.Size([3200, 128])
GATv2Layer输入 - x: torch.Size([3200, 128]), edge_index: torch.Size([2, 11631])
GATv2Layer卷积后 - out: torch.Size([3200, 55])
GNN编码器输出 - 形状: torch.Size([3200, 55])
注意力分数 - 形状: torch.Size([3200, 1])
最终输出 - 形状: torch.Size([3200, 55])
AdvancedAnomalyGNN输入 - 形状: torch.Size([64, 50, 55]), 通道数: 55
展平后的输入 - 形状: torch.Size([3200, 55])
GATv2Layer输入 - x: torch.Size([3200, 55]), edge_index: torch.Size([2, 11720])
GATv2Layer卷积后 - out: torch.Size([3200, 128])
GATv2Layer输入 - x: torch.Size([3200, 128]), edge_index: torch.Size([2, 11720])
GATv2Layer卷积后 - out: torch.Size([3200, 55])
GNN编码器输出 - 形状: torch.Size([3200, 55])
注意力分数 - 形状: torch.Size([3200, 1])
最终输出 - 形状: torch.Size([3200, 55])
AdvancedAnomalyGNN输入 - 形状: torch.Size([64, 50, 55]), 通道数: 55
展平后的输入 - 形状: torch.Size([3200, 55])
GATv2Layer输入 - x: torch.Size([3200, 55]), edge_index: torch.Size([2, 11749])
GATv2Layer卷积后 - out: torch.Size([3200, 128])
GATv2Layer输入 - x: torch.Size([3200, 128]), edge_index: torch.Size([2, 11749])
GATv2Layer卷积后 - out: torch.Size([3200, 55])
GNN编码器输出 - 形状: torch.Size([3200, 55])
注意力分数 - 形状: torch.Size([3200, 1])
最终输出 - 形状: torch.Size([3200, 55])
AdvancedAnomalyGNN输入 - 形状: torch.Size([64, 50, 55]), 通道数: 55
展平后的输入 - 形状: torch.Size([3200, 55])
GATv2Layer输入 - x: torch.Size([3200, 55]), edge_index: torch.Size([2, 11782])
GATv2Layer卷积后 - out: torch.Size([3200, 128])
GATv2Layer输入 - x: torch.Size([3200, 128]), edge_index: torch.Size([2, 11782])
GATv2Layer卷积后 - out: torch.Size([3200, 55])
GNN编码器输出 - 形状: torch.Size([3200, 55])
注意力分数 - 形状: torch.Size([3200, 1])
最终输出 - 形状: torch.Size([3200, 55])
AdvancedAnomalyGNN输入 - 形状: torch.Size([64, 50, 55]), 通道数: 55
展平后的输入 - 形状: torch.Size([3200, 55])
GATv2Layer输入 - x: torch.Size([3200, 55]), edge_index: torch.Size([2, 11768])
GATv2Layer卷积后 - out: torch.Size([3200, 128])
GATv2Layer输入 - x: torch.Size([3200, 128]), edge_index: torch.Size([2, 11768])
GATv2Layer卷积后 - out: torch.Size([3200, 55])
GNN编码器输出 - 形状: torch.Size([3200, 55])
注意力分数 - 形状: torch.Size([3200, 1])
最终输出 - 形状: torch.Size([3200, 55])
AdvancedAnomalyGNN输入 - 形状: torch.Size([64, 50, 55]), 通道数: 55
展平后的输入 - 形状: torch.Size([3200, 55])
GATv2Layer输入 - x: torch.Size([3200, 55]), edge_index: torch.Size([2, 11742])
GATv2Layer卷积后 - out: torch.Size([3200, 128])
GATv2Layer输入 - x: torch.Size([3200, 128]), edge_index: torch.Size([2, 11742])
GATv2Layer卷积后 - out: torch.Size([3200, 55])
GNN编码器输出 - 形状: torch.Size([3200, 55])
注意力分数 - 形状: torch.Size([3200, 1])
最终输出 - 形状: torch.Size([3200, 55])
AdvancedAnomalyGNN输入 - 形状: torch.Size([64, 50, 55]), 通道数: 55
展平后的输入 - 形状: torch.Size([3200, 55])
GATv2Layer输入 - x: torch.Size([3200, 55]), edge_index: torch.Size([2, 11860])
GATv2Layer卷积后 - out: torch.Size([3200, 128])
GATv2Layer输入 - x: torch.Size([3200, 128]), edge_index: torch.Size([2, 11860])
GATv2Layer卷积后 - out: torch.Size([3200, 55])
GNN编码器输出 - 形状: torch.Size([3200, 55])
注意力分数 - 形状: torch.Size([3200, 1])
最终输出 - 形状: torch.Size([3200, 55])
AdvancedAnomalyGNN输入 - 形状: torch.Size([64, 50, 55]), 通道数: 55
展平后的输入 - 形状: torch.Size([3200, 55])
GATv2Layer输入 - x: torch.Size([3200, 55]), edge_index: torch.Size([2, 11830])
GATv2Layer卷积后 - out: torch.Size([3200, 128])
GATv2Layer输入 - x: torch.Size([3200, 128]), edge_index: torch.Size([2, 11830])
GATv2Layer卷积后 - out: torch.Size([3200, 55])
GNN编码器输出 - 形状: torch.Size([3200, 55])
注意力分数 - 形状: torch.Size([3200, 1])
最终输出 - 形状: torch.Size([3200, 55])
AdvancedAnomalyGNN输入 - 形状: torch.Size([64, 50, 55]), 通道数: 55
展平后的输入 - 形状: torch.Size([3200, 55])
GATv2Layer输入 - x: torch.Size([3200, 55]), edge_index: torch.Size([2, 11927])
GATv2Layer卷积后 - out: torch.Size([3200, 128])
GATv2Layer输入 - x: torch.Size([3200, 128]), edge_index: torch.Size([2, 11927])
GATv2Layer卷积后 - out: torch.Size([3200, 55])
GNN编码器输出 - 形状: torch.Size([3200, 55])
注意力分数 - 形状: torch.Size([3200, 1])
最终输出 - 形状: torch.Size([3200, 55])
AdvancedAnomalyGNN输入 - 形状: torch.Size([64, 50, 55]), 通道数: 55
展平后的输入 - 形状: torch.Size([3200, 55])
GATv2Layer输入 - x: torch.Size([3200, 55]), edge_index: torch.Size([2, 11828])
GATv2Layer卷积后 - out: torch.Size([3200, 128])
GATv2Layer输入 - x: torch.Size([3200, 128]), edge_index: torch.Size([2, 11828])
GATv2Layer卷积后 - out: torch.Size([3200, 55])
GNN编码器输出 - 形状: torch.Size([3200, 55])
注意力分数 - 形状: torch.Size([3200, 1])
最终输出 - 形状: torch.Size([3200, 55])
AdvancedAnomalyGNN输入 - 形状: torch.Size([64, 50, 55]), 通道数: 55
展平后的输入 - 形状: torch.Size([3200, 55])
Epoch 1/3:   1%|▏         | 3/228 [01:24<1:19:11, 21.12s/it, loss=-93.0367, speed=21.17s/iter, memory=47MB]Epoch 1/3:   2%|▏         | 4/228 [01:24<1:18:23, 21.00s/it, loss=-93.0367, speed=21.17s/iter, memory=47MB]Epoch 1/3:   2%|▏         | 4/228 [01:45<1:18:23, 21.00s/it, loss=-93.7523, speed=21.17s/iter, memory=46MB]Epoch 1/3:   2%|▏         | 5/228 [01:45<1:18:16, 21.06s/it, loss=-93.7523, speed=21.17s/iter, memory=46MB]Epoch 1/3:   2%|▏         | 5/228 [02:04<1:18:16, 21.06s/it, loss=-94.3281, speed=20.83s/iter, memory=48MB]Epoch 1/3:   3%|▎         | 6/228 [02:04<1:15:31, 20.41s/it, loss=-94.3281, speed=20.83s/iter, memory=48MB]Epoch 1/3:   3%|▎         | 6/228 [02:23<1:15:31, 20.41s/it, loss=-93.6139, speed=20.55s/iter, memory=48MB]Epoch 1/3:   3%|▎         | 7/228 [02:23<1:13:15, 19.89s/it, loss=-93.6139, speed=20.55s/iter, memory=48MB]