------------ Options -------------
anormly_ratio: 4.0
batch_size: 16
d_ff: 32
d_model: 32
data_path: ./dataset/SWaT
dataset: SWaT
dynamic_graph: True
e_layers: 1
fusion_method: add
gnn_heads: 1
gnn_hidden: 32
gnn_layers: 1
gnn_type: gatv2
input_c: 51
k: 3
k_neighbors: 2
lr: 0.0001
mode: train
model_save_path: ./checkpoints
model_type: advanced_transgnn
n_heads: 2
no_time_limit: False
num_epochs: 5
output_c: 51
pretrained_model: None
residual: True
win_size: 30
-------------- End ----------------
自动调整batch_size: 16 -> 1024 (GPU内存: 23.59GB可用)
当前GPU利用率: 0.00%，目标提高到60-80%
训练数据特征数量: 51
测试数据特征数量: 50
已填充测试数据至 51 个特征
test: (495000, 51)
train: (495000, 51)
训练数据特征数量: 51
测试数据特征数量: 50
已填充测试数据至 51 个特征
test: (495000, 51)
train: (495000, 51)
训练数据特征数量: 51
测试数据特征数量: 50
已填充测试数据至 51 个特征
test: (495000, 51)
train: (495000, 51)
训练数据特征数量: 51
测试数据特征数量: 50
已填充测试数据至 51 个特征
test: (495000, 51)
train: (495000, 51)
检测到大显存GPU (23.6GB)，自动优化模型参数
已强制启用自动混合精度训练，提高GPU利用率
使用单GPU训练 - RTX 3090
模型总参数量: 3.72M 参数
初始GPU内存分配: 0.03GB
初始GPU内存预留: 0.04GB
已设置GPU内存使用上限为95%
CUDA性能优化设置完成，已针对RTX 3090进行优化
======================TRAIN MODE======================
降低batch_size以解决OOM问题: 1024 -> 256
训练数据特征数量: 51
测试数据特征数量: 50
已填充测试数据至 51 个特征
test: (495000, 51)
train: (495000, 51)
训练数据特征数量: 51
测试数据特征数量: 50
已填充测试数据至 51 个特征
test: (495000, 51)
train: (495000, 51)
训练数据特征数量: 51
测试数据特征数量: 50
已填充测试数据至 51 个特征
test: (495000, 51)
train: (495000, 51)
训练数据特征数量: 51
测试数据特征数量: 50
已填充测试数据至 51 个特征
test: (495000, 51)
train: (495000, 51)
已清空CUDA缓存，准备开始训练

开始第 1/5 轮训练
Epoch 1/5:   0%|          | 0/1934 [00:00<?, ?it/s]Epoch 1/5:   0%|          | 0/1934 [00:04<?, ?it/s, loss=-19.5305, speed=4.05s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   0%|          | 1/1934 [00:04<2:10:21,  4.05s/it, loss=-19.5305, speed=4.05s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   0%|          | 1/1934 [00:07<2:10:21,  4.05s/it, loss=-19.8101, speed=3.76s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   0%|          | 2/1934 [00:07<1:59:27,  3.71s/it, loss=-19.8101, speed=3.76s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   0%|          | 2/1934 [00:10<1:59:27,  3.71s/it, loss=-19.9584, speed=3.63s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   0%|          | 3/1934 [00:10<1:54:21,  3.55s/it, loss=-19.9584, speed=3.63s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   0%|          | 3/1934 [00:14<1:54:21,  3.55s/it, loss=-20.0211, speed=3.53s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   0%|          | 4/1934 [00:14<1:50:18,  3.43s/it, loss=-20.0211, speed=3.53s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   0%|          | 4/1934 [00:16<1:50:18,  3.43s/it, loss=-20.2257, speed=3.38s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   0%|          | 5/1934 [00:16<1:42:49,  3.20s/it, loss=-20.2257, speed=3.38s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   0%|          | 5/1934 [00:19<1:42:49,  3.20s/it, loss=-20.7996, speed=3.31s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   0%|          | 6/1934 [00:19<1:40:05,  3.11s/it, loss=-20.7996, speed=3.31s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   0%|          | 6/1934 [00:23<1:40:05,  3.11s/it, loss=-20.9159, speed=3.30s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   0%|          | 7/1934 [00:23<1:41:29,  3.16s/it, loss=-20.9159, speed=3.30s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   0%|          | 7/1934 [00:25<1:41:29,  3.16s/it, loss=-21.8149, speed=3.23s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   0%|          | 8/1934 [00:25<1:37:08,  3.03s/it, loss=-21.8149, speed=3.23s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   0%|          | 8/1934 [00:28<1:37:08,  3.03s/it, loss=-22.9755, speed=3.18s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   0%|          | 9/1934 [00:28<1:34:31,  2.95s/it, loss=-22.9755, speed=3.18s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   0%|          | 9/1934 [00:31<1:34:31,  2.95s/it, loss=-23.4209, speed=3.19s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 10/1934 [00:31<1:37:27,  3.04s/it, loss=-23.4209, speed=3.19s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 10/1934 [00:34<1:37:27,  3.04s/it, loss=-24.8847, speed=0.25s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 11/1934 [00:34<1:34:17,  2.94s/it, loss=-24.8847, speed=0.25s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 11/1934 [00:37<1:34:17,  2.94s/it, loss=-26.7998, speed=0.50s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 12/1934 [00:37<1:37:55,  3.06s/it, loss=-26.7998, speed=0.50s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 12/1934 [00:41<1:37:55,  3.06s/it, loss=-28.4546, speed=0.72s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 13/1934 [00:41<1:40:41,  3.14s/it, loss=-28.4546, speed=0.72s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 13/1934 [00:43<1:40:41,  3.14s/it, loss=-30.0065, speed=0.86s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 14/1934 [00:43<1:36:26,  3.01s/it, loss=-30.0065, speed=0.86s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 14/1934 [00:46<1:36:26,  3.01s/it, loss=-31.7042, speed=0.98s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 15/1934 [00:46<1:32:56,  2.91s/it, loss=-31.7042, speed=0.98s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 15/1934 [00:49<1:32:56,  2.91s/it, loss=-33.4762, speed=1.12s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 16/1934 [00:49<1:35:34,  2.99s/it, loss=-33.4762, speed=1.12s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 16/1934 [00:52<1:35:34,  2.99s/it, loss=-34.6373, speed=1.21s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 17/1934 [00:52<1:32:15,  2.89s/it, loss=-34.6373, speed=1.21s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 17/1934 [00:55<1:32:15,  2.89s/it, loss=-35.6297, speed=1.30s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 18/1934 [00:55<1:30:48,  2.84s/it, loss=-35.6297, speed=1.30s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 18/1934 [00:58<1:30:48,  2.84s/it, loss=-37.0143, speed=1.40s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 19/1934 [00:58<1:34:27,  2.96s/it, loss=-37.0143, speed=1.40s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 19/1934 [01:01<1:34:27,  2.96s/it, loss=-37.7794, speed=1.47s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 20/1934 [01:01<1:32:36,  2.90s/it, loss=-37.7794, speed=1.47s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 20/1934 [01:04<1:32:36,  2.90s/it, loss=-38.4370, speed=0.15s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 21/1934 [01:04<1:35:13,  2.99s/it, loss=-38.4370, speed=0.15s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 21/1934 [01:07<1:35:13,  2.99s/it, loss=-39.0624, speed=0.27s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 22/1934 [01:07<1:32:51,  2.91s/it, loss=-39.0624, speed=0.27s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 22/1934 [01:10<1:32:51,  2.91s/it, loss=-39.7592, speed=0.40s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 23/1934 [01:10<1:35:54,  3.01s/it, loss=-39.7592, speed=0.40s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 23/1934 [01:13<1:35:54,  3.01s/it, loss=-40.0113, speed=0.50s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 24/1934 [01:13<1:33:40,  2.94s/it, loss=-40.0113, speed=0.50s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|          | 24/1934 [01:16<1:33:40,  2.94s/it, loss=-40.2472, speed=0.61s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|▏         | 25/1934 [01:16<1:36:33,  3.03s/it, loss=-40.2472, speed=0.61s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|▏         | 25/1934 [01:19<1:36:33,  3.03s/it, loss=-40.7305, speed=0.71s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|▏         | 26/1934 [01:19<1:38:06,  3.09s/it, loss=-40.7305, speed=0.71s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|▏         | 26/1934 [01:22<1:38:06,  3.09s/it, loss=-40.9863, speed=0.80s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|▏         | 27/1934 [01:22<1:39:02,  3.12s/it, loss=-40.9863, speed=0.80s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|▏         | 27/1934 [01:25<1:39:02,  3.12s/it, loss=-41.2915, speed=0.87s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|▏         | 28/1934 [01:25<1:36:00,  3.02s/it, loss=-41.2915, speed=0.87s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|▏         | 28/1934 [01:28<1:36:00,  3.02s/it, loss=-41.5645, speed=0.94s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|▏         | 29/1934 [01:28<1:33:09,  2.93s/it, loss=-41.5645, speed=0.94s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   1%|▏         | 29/1934 [01:31<1:33:09,  2.93s/it, loss=-41.6411, speed=1.00s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   2%|▏         | 30/1934 [01:31<1:32:27,  2.91s/it, loss=-41.6411, speed=1.00s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   2%|▏         | 30/1934 [01:33<1:32:27,  2.91s/it, loss=-41.6475, speed=0.09s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   2%|▏         | 31/1934 [01:33<1:30:45,  2.86s/it, loss=-41.6475, speed=0.09s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   2%|▏         | 31/1934 [01:37<1:30:45,  2.86s/it, loss=-42.3836, speed=0.19s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   2%|▏         | 32/1934 [01:37<1:34:45,  2.99s/it, loss=-42.3836, speed=0.19s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   2%|▏         | 32/1934 [01:39<1:34:45,  2.99s/it, loss=-42.5067, speed=0.26s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   2%|▏         | 33/1934 [01:39<1:31:42,  2.89s/it, loss=-42.5067, speed=0.26s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   2%|▏         | 33/1934 [01:43<1:31:42,  2.89s/it, loss=-42.7409, speed=0.35s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   2%|▏         | 34/1934 [01:43<1:34:20,  2.98s/it, loss=-42.7409, speed=0.35s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   2%|▏         | 34/1934 [01:45<1:34:20,  2.98s/it, loss=-42.8612, speed=0.42s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   2%|▏         | 35/1934 [01:45<1:32:24,  2.92s/it, loss=-42.8612, speed=0.42s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   2%|▏         | 35/1934 [01:48<1:32:24,  2.92s/it, loss=-42.9575, speed=0.48s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]Epoch 1/5:   2%|▏         | 36/1934 [01:48<1:30:13,  2.85s/it, loss=-42.9575, speed=0.48s/iter, memory=0.2GB/23.6GB (1%), gpu_mem=0.2GB]